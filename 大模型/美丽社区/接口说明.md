# 1. å¾®ä¿¡æ¥å£
## 1.1 å¾®ä¿¡æ¥å£è¯·æ±‚æ–¹å¼
### 1.1.1 å‘é€
é€šè¿‡ POST æ–¹æ³•è¿›è¡Œè°ƒç”¨

```shell
curl -X POST "http://127.0.0.1:8000" \
     -H 'Content-Type: application/json' \
     -d '{"prompt": "ä½ å¥½", "history": []}'
```

å­—æ®µè¯´æ˜ï¼š
- promptï¼šstrç±»å‹ï¼Œç”¨æˆ·é—®é¢˜
- historyï¼šlistç±»å‹ï¼Œå†å²è®°å½•ï¼Œæš‚æ—¶ä¿æŒç©ºå€¼

### 1.1.2 æ¥æ”¶
å¾—åˆ°çš„è¿”å›å€¼ä¸º

```json
{
  "response":"ä½ å¥½ğŸ‘‹ï¼æˆ‘æ˜¯äººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œå¾ˆé«˜å…´è§åˆ°ä½ ï¼Œæ¬¢è¿é—®æˆ‘ä»»ä½•é—®é¢˜ã€‚",
  "history":[{"role": "internal", "content": "Q01å©šå§»ç™»è®°"}],
  "status":200,
  "time":"2023-03-23 21:38:40"
}
```

å­—æ®µè¯´æ˜ï¼š
- responseï¼šstrç±»å‹ï¼Œæœºå™¨äººå›å¤
- historyï¼šlistç±»å‹ï¼Œå†å²è®°å½•ä¸­æœ‰internalæ—¶ï¼Œå¯åŠ¨å°ç¨‹åº

## 1.2 å°ç¨‹åºè°ƒç”¨

ä¼ å…¥å‚æ•°ï¼šç”¨æˆ·é—®é¢˜+internalä¸­çš„content

# 2. å°ç¨‹åºæ¥å£
## 2.1 å°ç¨‹åºæ¥å£è¯·æ±‚æ–¹å¼

é€šè¿‡ POST æ–¹æ³•è¿›è¡Œè°ƒç”¨

```shell
curl -X POST "http://127.0.0.1:8000/mini_app" \
     -H 'Content-Type: application/json' \
     -d '{"prompt": {id: str, type: int, content: str}, "history": []}'
```

å¾—åˆ°çš„è¿”å›å€¼ä¸º

```json
{
  "response":"ä½ å¥½ğŸ‘‹ï¼æˆ‘æ˜¯äººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œå¾ˆé«˜å…´è§åˆ°ä½ ï¼Œæ¬¢è¿é—®æˆ‘ä»»ä½•é—®é¢˜ã€‚",
  "history":[
     {"role": "system", "content": "xxx"}, 
     {"role": "user", "content": "xxx"}, 
     {"role": "assistant", "content": "xxxxx"}, 
     {"role": "internal", "content": "xxxxx"}],
  "recommend": {"type":1, "content": ["é€‰é¡¹1", "é€‰é¡¹2"]},
  "status":200,
  "time":"2023-03-23 21:38:40"
}
```

# 2.å­—æ®µè¯¦ç»†è¯´æ˜
## 2.1 å‘é€å­—æ®µ

1. promptå­—æ®µï¼š

   - ç±»å‹ï¼šå­—å…¸
   - {id: str, type: int, content: str}
     - id: ç‚¹é€‰id
     - type: 0-ç‚¹é€‰ï¼Œ1-æ–‡æœ¬è¾“å…¥

2. historyå­—æ®µ

   - ç±»å‹ï¼šåˆ—è¡¨
   - çŠ¶æ€å­˜å‚¨ï¼Œä¸åšå¤„ç†

## 2.2 æ¥æ”¶å­—æ®µ

1. å†å²

    ```json
    [
      {"role": "system", "content": "ä½ æ˜¯AIæœºå™¨äºº"},  // ç³»ç»ŸæŒ‡ä»¤
      {"role": "user", "content": "xxx"},  // ç”¨æˆ·é—®é¢˜
      {"role": "assistant", "content": "xxxxx"},  // æ¨¡å‹å›å¤
      {"role": "internal", "content": "abc"}  // å†…éƒ¨çŠ¶æ€
    ]
    ```

2. recommendä¸­çš„ä¸åŒæ ·å¼

   - {'type':1, 'content': []}
   - 1:çº¯æ–‡æœ¬
   - 2:é€‰é¡¹å¡ ï¼ˆç‚¹é€‰å†…å®¹ï¼‰
   - 3:è¯¦æƒ…ï¼ˆåœ°ç‚¹ã€æ—¶é—´ã€äº¤é€šï¼‰
   - 4:å±‚çº§å±•ç¤º ('ç”³è¯·ææ–™', 'åŠç†æµç¨‹', 'åŠç†æ¡ä»¶')

## 2.3 è°ƒç”¨é€»è¾‘
1.é¦–æ¬¡è¿›å…¥
 
  å°†urlæ‹†è§£åˆ†åˆ«å­˜å…¥promptï¼Œåœ¨historyä¸­åŠ å…¥internal
  
2.æµç¨‹å›é€€
   
   æ ¹æ®ç•Œé¢å›é€€çš„ä½ç½®ï¼Œå¯¹åº”æ¸…é™¤historyä¸­çš„å†…å®¹ï¼Œæ¯userå’ŒassistantåŠinternalä¸ºä¸€ç»„

3.æŠ¥é”™æƒ…å†µ

   ç­”å¤â€ç³»ç»Ÿè¿æ¥å¼‚å¸¸ï¼Œè¯·ç¨åå†è¯•â€œ
 